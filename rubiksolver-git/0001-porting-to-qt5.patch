From 0afad50d0ea79102cc341b9b7b381746edd190cb Mon Sep 17 00:00:00 2001
From: Sergio Correia <sergio@correia.cc>
Date: Mon, 4 Mar 2013 00:11:17 -0400
Subject: [PATCH] porting to qt5

Signed-off-by: Sergio Correia <sergio@correia.cc>
---
 qml/generic/platform.js | 112 +-----------------------------------------------
 qml/rubik/Rubik.qml     |   2 +-
 src/main.cpp            |  13 +++---
 src/rubikfacemodel.cpp  |   9 ++--
 src/rubikfacemodel.h    |   7 ++-
 src/src.pro             |   2 +-
 6 files changed, 20 insertions(+), 125 deletions(-)
 mode change 100644 => 120000 qml/generic/platform.js

diff --git a/qml/generic/platform.js b/qml/generic/platform.js
deleted file mode 100644
index 066455f..0000000
--- a/qml/generic/platform.js
+++ /dev/null
@@ -1,111 +0,0 @@
-var scaleFactor = 0.9
-
-var width = 480
-var height = 800
-
-// buttons setup
-var scrambleButtonOffsetX = -18
-var scrambleButtonOffsetY = 60
-
-var resetButtonOffsetX = 0
-var resetButtonOffsetY = -5
-
-var solveButtonOffsetX = -20
-var solveButtonOffsetY = -30
-
-var doneButtonOffsetX = solveButtonOffsetX
-var doneButtonOffsetY = solveButtonOffsetY
-
-
-// buttons solution
-var backButtonOffsetX = 0
-var backButtonOffsetY = -5
-
-var previousButtonOffsetX = -40
-var previousButtonOffsetY = -30
-
-var nextButtonOffsetX = -14
-var nextButtonOffsetY = -26
-
-
-// main cube faces
-var frontFaceCubeSetupX = 350
-var frontFaceCubeSetupY = 350
-
-var leftFaceCubeSetupX = 460
-var leftFaceCubeSetupY = 620
-
-var rightFaceCubeSetupX = 130
-var rightFaceCubeSetupY = 350
-
-var backFaceCubeSetupX = 20
-var backFaceCubeSetupY = 600
-
-var topFaceCubeSetupX = 250
-var topFaceCubeSetupY = 500
-
-var bottomFaceCubeSetupX = 240
-var bottomFaceCubeSetupY = 150
-
-
-// texts solution
-var solutionTextX = 30
-var solutionMovesY = 80
-var solutionRemaninngMovesY = 120
-var solutionHintY = 575
-var solutionMoveDescriptionY = 615
-
-
-// arrows
-var arrowDimension = 238
-
-var arrowPositions = {
-    "UL": {
-        x: 185,
-        y: 250
-    },
-    "UR": {
-        x: 49,
-        y: 253
-    },
-    "DL": {
-        x: 188,
-        y: 354
-    },
-    "DR": {
-        x: 50,
-        y: 357
-    },
-    "LU": {
-        x: 3,
-        y: 308
-    },
-    "LD": {
-        x: 80,
-        y: 186
-    },
-    "RU": {
-        x: 97,
-        y: 363
-    },
-    "RD": {
-        x: 170,
-        y: 240
-    },
-    "FC": {
-        x: 58,
-        y: 245
-    },
-    "FA": {
-        x: 134,
-        y: 355
-    },
-    "BC": {
-        x: 155,
-        y: 190
-    },
-    "BA": {
-        x: 230,
-        y: 310
-    }
-};
diff --git a/qml/generic/platform.js b/qml/generic/platform.js
new file mode 120000
index 0000000..9873c8b
--- /dev/null
+++ b/qml/generic/platform.js
@@ -0,0 +1 @@
+platform-640x360.js
\ No newline at end of file
diff --git a/qml/rubik/Rubik.qml b/qml/rubik/Rubik.qml
index 04bc1ef..b63f4f0 100644
--- a/qml/rubik/Rubik.qml
+++ b/qml/rubik/Rubik.qml
@@ -35,7 +35,7 @@ Item {
     Image {
         id: bgCube
         smooth: true
-        source: ":/img/bg-cube.png"
+        source: "qrc:/img/bg-cube.png"
         anchors.centerIn: parent
         z: 1
     }
diff --git a/src/main.cpp b/src/main.cpp
index 66e503e..4a6e6ad 100644
--- a/src/main.cpp
+++ b/src/main.cpp
@@ -1,9 +1,8 @@
-#include <QtGui/QApplication>
-#include <QtGui/QDesktopWidget>
-#include <QtGui/QFontDatabase>
-#include <QtCore/QUrl>
-#include <QtCore/QFile>
-#include <QtCore/QDebug>
+#include <QApplication>
+#include <QDesktopWidget>
+#include <QFontDatabase>
+#include <QUrl>
+#include <QFile>
 #include "mainview.h"
 #include <stdio.h>
 Q_DECL_EXPORT int main(int argc, char *argv[])
@@ -31,7 +30,7 @@ Q_DECL_EXPORT int main(int argc, char *argv[])
 
     view.showFullScreen();
 #else
-    view.setFixedSize(480, 800);
+    view.setFixedSize(360, 640);
     view.show();
 #endif
 
diff --git a/src/rubikfacemodel.cpp b/src/rubikfacemodel.cpp
index 14684e1..de8e628 100644
--- a/src/rubikfacemodel.cpp
+++ b/src/rubikfacemodel.cpp
@@ -6,15 +6,18 @@ RubikFaceModel::RubikFaceModel(Cubex *cube, RubikFace face, QObject *parent)
       m_cube(cube),
       m_face(face)
 {
-    QHash<int, QByteArray> roles;
-    roles[ColorIndex] = "colorIndex";
-    setRoleNames(roles);
+    m_roles[ColorIndex] = "colorIndex";
 }
 
 RubikFaceModel::~RubikFaceModel()
 {
 }
 
+QHash<int,QByteArray> RubikFaceModel::roleNames() const
+{
+    return m_roles;
+}
+
 int RubikFaceModel::rowCount(const QModelIndex &parent) const
 {
     Q_UNUSED(parent);
diff --git a/src/rubikfacemodel.h b/src/rubikfacemodel.h
index 7d44ce4..cc9bad2 100644
--- a/src/rubikfacemodel.h
+++ b/src/rubikfacemodel.h
@@ -1,8 +1,9 @@
 #ifndef RUBIKFACEMODEL_H
 #define RUBIKFACEMODEL_H
 
-#include <QtCore/QObject>
-#include <QtCore/QAbstractListModel>
+#include <QObject>
+#include <QHash>
+#include <QAbstractListModel>
 
 #include "solver/cubex.h"
 
@@ -38,10 +39,12 @@ public:
     void notifyLayoutChanged();
 
     int *getSticker(int) const;
+    QHash<int,QByteArray> roleNames() const;
 
 private:
     Cubex *m_cube;
     RubikFace m_face;
+    QHash<int,QByteArray> m_roles;
 };
 
 
diff --git a/src/src.pro b/src/src.pro
index fb258b6..7522b1f 100644
--- a/src/src.pro
+++ b/src/src.pro
@@ -4,7 +4,7 @@ TEMPLATE = app
 TARGET = rubiksolver
 VERSION = 0.1
 
-QT += declarative opengl
+QT += declarative
 
 CONFIG += mobility
 MOBILITY += multimedia
-- 
1.8.1.5

