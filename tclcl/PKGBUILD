# Maintainer: Sergio Correia <sergio.correia@uece.net>
# Contributor: Oleg Smirnov <oleg.smirnov@gmail.com>
# Contributor: Luke McCarthy <luke@iogopro.co.uk>

pkgname=tclcl
pkgver=1.20
pkgrel=2
pkgdesc="Tcl with classes (TclCl) is a Tcl/C++ interface"
url="http://otcl-tclcl.sourceforge.net/tclcl/"
license=('MIT')
depends=('gcc-libs')
makedepends=('otcl')
arch=('i686' 'x86_64')
source=(http://downloads.sourceforge.net/sourceforge/otcl-tclcl/tclcl-src-"${pkgver}".tar.gz
        tclcl-1.20-tcl86-compat.patch)

md5sums=('91d48d6694ae06cd29c627df6b78534a'
         'd4fd3712f4222a8aea1ea6b1e038fb37')

prepare() {
    cd "${srcdir}"/"${pkgname}"-"${pkgver}"
    patch -Np1 -i ../tclcl-1.20-tcl86-compat.patch
}

build() {
    cd "${srcdir}"/"${pkgname}"-"${pkgver}"
    ./configure --prefix="${pkgdir}"/usr/lib/tclcl
    make
}

package() {
    cd "${srcdir}"/"${pkgname}"-"${pkgver}"
    install -d "${pkgdir}"/usr/lib/tclcl
    install -d "${pkgdir}"/usr/lib/tclcl/bin
    install -d "${pkgdir}"/usr/lib/tclcl/include
    install -d "${pkgdir}"/usr/lib/tclcl/lib
    make install

    # fix .a permissions
    chmod 644 "${pkgdir}"/usr/lib/tclcl/lib/*.a
    ln -s bin/tcl2c++ "${pkgdir}"/usr/lib/tclcl/tcl2c++
}
